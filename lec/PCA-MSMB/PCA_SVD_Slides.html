<!DOCTYPE html>
<html lang="en"><head>
<script src="PCA_SVD_Slides_files/libs/clipboard/clipboard.min.js"></script>
<script src="PCA_SVD_Slides_files/libs/quarto-html/tabby.min.js"></script>
<script src="PCA_SVD_Slides_files/libs/quarto-html/popper.min.js"></script>
<script src="PCA_SVD_Slides_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="PCA_SVD_Slides_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="PCA_SVD_Slides_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="PCA_SVD_Slides_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">
<meta name="author" content="Wolfgang Huber, Susan Holmes. Updates by Helena Crowell">
<meta name="dcterms.date" content="2023-07-01">
<title>Multivariate Analysis</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="PCA_SVD_Slides_files/libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="PCA_SVD_Slides_files/libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="PCA_SVD_Slides_files/libs/revealjs/dist/theme/quarto.css" id="theme">
<link href="PCA_SVD_Slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="PCA_SVD_Slides_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="PCA_SVD_Slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="PCA_SVD_Slides_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center"><h1 class="title">Multivariate Analysis</h1>
  <p class="subtitle">BDS^3 Uzhhorod, Ukraine</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Wolfgang Huber, Susan Holmes. Updates by Helena Crowell 
</div>
</div>
</div>

  <p class="date">2023-07-01</p>
</section><section id="matrices-and-their-motivation" class="slide level1"><h1>Matrices and their Motivation</h1>
<div class="cell">

</div>
<p>Measure multiple variables on the same subjects. E.g., for cohort of people: biometrical characteristics such as height, weight, BMI, age; as well as clinical variables such as blood pressure, blood sugar, heart rate. These variables will not be independent, we are interested in finding patterns between them.</p>
<p><img data-src="resources/TheMatrix.jpg"></p>
</section><section id="exemplary-data-sets" class="slide level1"><h1>Exemplary data sets</h1>
<h2 id="decathlon">Decathlon</h2>
<p>Athletes’ performances in the Olympic decathlon:<br><code>m100</code>, <code>m400</code>, <code>m1500</code> are performance times in seconds for the 100 metres, 400 metres and 1500 meters. <code>m110</code> is the time taken to finish the 110 meters hurdles. <code>pole</code> is the pole-jump height, and <code>weight</code> is the length in metres the athletes threw the weight.</p>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead><tr class="header">
<th style="text-align: left;">m100</th>
<th style="text-align: left;">long</th>
<th style="text-align: left;">weight</th>
<th style="text-align: left;">highj</th>
<th style="text-align: left;">m400</th>
<th style="text-align: left;">m110</th>
<th style="text-align: left;">disc</th>
<th style="text-align: left;">pole</th>
<th style="text-align: left;">javel</th>
<th style="text-align: left;">m1500</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">11.25</td>
<td style="text-align: left;">7.43</td>
<td style="text-align: left;">15.48</td>
<td style="text-align: left;">2.27</td>
<td style="text-align: left;">48.90</td>
<td style="text-align: left;">15.13</td>
<td style="text-align: left;">49.28</td>
<td style="text-align: left;">4.70</td>
<td style="text-align: left;">61.32</td>
<td style="text-align: left;">268.95</td>
</tr>
<tr class="even">
<td style="text-align: left;">10.87</td>
<td style="text-align: left;">7.45</td>
<td style="text-align: left;">14.97</td>
<td style="text-align: left;">1.97</td>
<td style="text-align: left;">47.71</td>
<td style="text-align: left;">14.46</td>
<td style="text-align: left;">44.36</td>
<td style="text-align: left;">5.10</td>
<td style="text-align: left;">61.76</td>
<td style="text-align: left;">273.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11.18</td>
<td style="text-align: left;">7.44</td>
<td style="text-align: left;">14.20</td>
<td style="text-align: left;">1.97</td>
<td style="text-align: left;">48.29</td>
<td style="text-align: left;">14.81</td>
<td style="text-align: left;">43.66</td>
<td style="text-align: left;">5.20</td>
<td style="text-align: left;">64.16</td>
<td style="text-align: left;">263.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">10.62</td>
<td style="text-align: left;">7.38</td>
<td style="text-align: left;">15.02</td>
<td style="text-align: left;">2.03</td>
<td style="text-align: left;">49.06</td>
<td style="text-align: left;">14.72</td>
<td style="text-align: left;">44.80</td>
<td style="text-align: left;">4.90</td>
<td style="text-align: left;">64.04</td>
<td style="text-align: left;">285.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">11.02</td>
<td style="text-align: left;">7.43</td>
<td style="text-align: left;">12.92</td>
<td style="text-align: left;">1.97</td>
<td style="text-align: left;">47.44</td>
<td style="text-align: left;">14.40</td>
<td style="text-align: left;">41.20</td>
<td style="text-align: left;">5.20</td>
<td style="text-align: left;">57.46</td>
<td style="text-align: left;">256.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">10.83</td>
<td style="text-align: left;">7.72</td>
<td style="text-align: left;">13.58</td>
<td style="text-align: left;">2.12</td>
<td style="text-align: left;">48.34</td>
<td style="text-align: left;">14.18</td>
<td style="text-align: left;">43.06</td>
<td style="text-align: left;">4.90</td>
<td style="text-align: left;">52.18</td>
<td style="text-align: left;">274.07</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h2 id="diabetes">Diabetes</h2>
<p>Clinical measurements: glucose levels in the blood after fasting (<code>glufast</code>), after a test condition (<code>glutest</code>) as well as steady state plasma glucose (<code>steady</code>) and steady state (<code>insulin</code>) for diabetes. The sixth variable is categorical.</p>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">relwt</th>
<th style="text-align: right;">glufast</th>
<th style="text-align: right;">glutest</th>
<th style="text-align: right;">steady</th>
<th style="text-align: right;">insulin</th>
<th style="text-align: right;">Group</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">356</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">319</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">323</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">7</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">221</td>
<td style="text-align: right;">119</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h2 id="microbial-ecology">Microbial Ecology</h2>
<p>Operational Taxon Unit read counts in a microbial ecology study. Columns represent different ‘species’ of bacteria,<br>
rows are labeled for the samples.</p>
<pre><code>                 469478 208196 378462 265971 570812
    EKCM1.489478      0      0      2      0      0
    EKCM7.489464      0      0      2      0      2
    EKBM2.489466      0      0     12      0      0
    PTCM3.489508      0      0     14      0      0
    EKCF2.489571      0      0      4      0      0
    </code></pre>
<h2 id="rna-seq">RNA-Seq</h2>
<p>Numbers of reads per gene for different patient samples, rows are patients and columns are genes.</p>
<pre><code>               FBgn0000017 FBgn0000018 FBgn0000022 FBgn0000024 FBgn0000028 FBgn0000032
    untreated1        4664         583           0          10           0        1446
    untreated2        8714         761           1          11           1        1713
    untreated4        3150         310           0           3           0         672
    treated1          6205         722           0          10           0        1698
    treated3          3334         308           0           5           1         757
    </code></pre>
<h2 id="mass-spectroscopy">Mass Spectroscopy</h2>
<p>Mass spectroscopy data where we have samples containing<br>
informative labels (knockout versus wildtype mice) and<br>
protein <span class="math inline">\(\times\)</span> features designated by their m/z number.</p>
<pre><code>    mz       129.9816   72.08144  151.6255  142.0349  169.0413    186.0355
    KOGCHUM1  60515      181495          0    196526    25500     51504.40
    WTGCHUM1 252579       54697        412    487800    48775    130491.15
    WTGCHUM2 187859       56318      46425    454226    45626    100845.01
    </code></pre>
<h2 id="expression-data-microarray">Expression Data (microarray)</h2>
<p>Here the rows are samples from different subjects and different<br>
T cell types and the columns are a subset of gene expression<br>
measurements on the 156 most differentially expressed genes.</p>
<div class="cell">
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">X3968</th>
<th style="text-align: right;">X14831</th>
<th style="text-align: right;">X13492</th>
<th style="text-align: right;">X5108</th>
<th style="text-align: right;">X16348</th>
<th style="text-align: right;">X585</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">HEA26_EFFE_1</td>
<td style="text-align: right;">-2.61</td>
<td style="text-align: right;">-1.19</td>
<td style="text-align: right;">-0.06</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">-0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">HEA26_MEM_1</td>
<td style="text-align: right;">-2.26</td>
<td style="text-align: right;">-0.47</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">0.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HEA26_NAI_1</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">-0.90</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="even">
<td style="text-align: left;">MEL36_EFFE_1</td>
<td style="text-align: right;">-2.24</td>
<td style="text-align: right;">-1.08</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">-0.18</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MEL36_MEM_1</td>
<td style="text-align: right;">-2.68</td>
<td style="text-align: right;">-0.15</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">-0.20</td>
<td style="text-align: right;">0.17</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h2 id="biometrical-measurements">Biometrical Measurements</h2>
<p>Turtles</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">turtles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/PaintedTurtles.txt"</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">turtles</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead><tr class="header">
<th style="text-align: left;">sex</th>
<th style="text-align: right;">length</th>
<th style="text-align: right;">width</th>
<th style="text-align: right;">height</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">f</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">f</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="odd">
<td style="text-align: left;">f</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="even">
<td style="text-align: left;">f</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">40</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Lizards</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://pbil.univ-lyon1.fr/ADE-4/">"ade4"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"lizards"</span><span class="op">)</span></span>
<span><span class="va">lizards</span><span class="op">$</span><span class="va">traits</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mean.L</th>
<th style="text-align: right;">hatch.m</th>
<th style="text-align: right;">clutch.S</th>
<th style="text-align: right;">age.mat</th>
<th style="text-align: right;">clutch.F</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sa</td>
<td style="text-align: right;">69.2</td>
<td style="text-align: right;">0.572</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sh</td>
<td style="text-align: right;">48.4</td>
<td style="text-align: right;">0.310</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tl</td>
<td style="text-align: right;">168.4</td>
<td style="text-align: right;">2.235</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mc</td>
<td style="text-align: right;">66.1</td>
<td style="text-align: right;">0.441</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section><section id="data-visualization-and-preparation" class="slide level1"><h1>Data visualization and preparation</h1>
<p>It is always beneficial to start a multidimensional analysis<br>
by checking the simple one dimensional and two dimensional<br>
summary statistics, we can visualize these using a graphics<br>
package that builds on <code>ggplot2</code> called <code>GGally</code>.</p>
<h2 id="low-dimensional-data-summaries-and-preparation">Low dimensional data summaries and preparation</h2>
<p>What do we mean by low dimensional?</p>
<p><img data-src="resources/flatland.png" style="width:80.0%"></p>
<p>If we are studying only one variable, just one column of our matrix,<br>
we might call it <span class="math inline">\({\mathbf x}\)</span> or <span class="math inline">\({\mathbf x}_{\bullet j}\)</span>; we call it one dimensional.</p>
<p>A <em>one dimensional summary</em> a histogram that shows that variable’s distribution,<br>
or we could compute its mean <span class="math inline">\(\bar{x}\)</span> or median, these are zero-th dimensional<br>
summaries of one dimension data.</p>
<p>In lecture 3 we studied two dimensional scatterplots.</p>
<p>When considering two variables (<span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>) measured together on a set of observations,<br>
the <strong>correlation coefficient</strong> measures how the variables co-vary.</p>
<p>This is a single number summarizes two dimensional data, its formula involves <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span>: <span class="math display">\[\hat{\rho}=\frac{\sum_{i=1}^n (x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum_{i=1}^n (x_i-\bar{x})^2}
\sqrt{\sum_{i=1}^n (y_i-\bar{y})^2}}
\label{eq:corrcoeff}\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">turtles</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       length width height
length  1.000 0.978  0.965
width   0.978 1.000  0.961
height  0.965 0.961  1.000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">turtles</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, axisLabels<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/turtlespairs-1.png" width="288"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">athletes</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/PairsAthletes-1.png" width="432"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pheatmap</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html">pheatmap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">athletes</span><span class="op">)</span>, cell.width<span class="op">=</span><span class="fl">10</span>, cell.height<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/heatmapathletes-1.png" width="403"></p>
</div>
</div>
</section><section id="a-little-history" class="slide level1"><h1>A Little History</h1>
<p>Invented in 1901 by Karl Pearson as a way to reduce<br>
a two variable scatterplot to a single coordinate.</p>
<p>Used by statisticians in the 1930s to summarize a battery of psychological<br>
tests run on the same subjects Hotelling:1933, extracting overall scores<br>
that could summarize many variables at once.</p>
<p>It is called Principal Component Analysis (abbreviated PCA).</p>
<p><strong>Not principled.</strong></p>
</section><section id="dimension-reduction" class="slide level1"><h1>Dimension reduction</h1>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>PCA is an ‘unsupervised learning technique’<br>
because it treats all variables as having<br>
the same status.</p>
<p>PCA is visualization technique which produces<br>
maps of both variables and observations.</p>
<p>We are going to give you a flavor of<br>
what is called multivariate analyses.</p>
<p>As a useful first approximation, we<br>
formulate many of the methods through<br>
manipulations called linear algebra.</p>
<p>The <em>raison d’être</em> for multivariate analyses<br>
is connections or associations between<br>
the different variables.</p>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>If the columns of the matrix are unrelated,<br>
we should just study each column separately<br>
and do standard univariate statistics on them<br>
one by one.</p>
<p>Use geometry:</p>
<p><img data-src="resources/projectionvector.jpg"></p>
</div>
</div>
</div>
<h2 id="low-dimensional-projections">Low Dimensional Projections</h2>
<p>Here we show one way of projecting two dimensional data onto a line.</p>
<p>The olympic data come from the <code>ade4</code> package, they are the<br>
performances of decathlon athletes in an olympic competition.</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/SS-1.png" width="480"></p>
</div>
</div>
<p>Scatterplot of two variables showing projection on the x coordinate in red.</p>
</section><section id="how-do-we-summarize-two-dimensional-data-by-a-line" class="slide level1"><h1>How do we summarize two <br> dimensional data by a line?</h1>
<p>In general, we lose information about the points when we<br>
project down from two dimensions (a plane) to one (a line).</p>
<p>If we do it just by using the original coordinates, e.g., the x coordinate<br>
as we did above, we lose all the information about the second one.</p>
<p>There are actually many ways of projecting the point cloud<br>
onto a line. One is to use what are known as regression lines.<br>
Let’s look at these lines and how there are constructed in R:</p>
<h2 id="regressing-one-variable-on-the-other">Regressing one variable on the other</h2>
<h3 id="the-disc-variable-on-the-weight">The disc variable on the weight</h3>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="va">athletes</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">reg1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">disc</span><span class="op">~</span><span class="va">weight</span>, data<span class="op">=</span><span class="va">athletes</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">reg1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># intercept</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">reg1</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co"># slope</span></span>
<span><span class="va">pline</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept<span class="op">=</span><span class="va">a</span>, slope<span class="op">=</span><span class="va">b</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="va">proj</span> <span class="op">&lt;-</span> <span class="va">pline</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span></span>
<span>  x<span class="op">=</span><span class="va">weight</span>, xend<span class="op">=</span><span class="va">weight</span>,</span>
<span>  y<span class="op">=</span><span class="va">disc</span>, yend<span class="op">=</span><span class="va">reg1</span><span class="op">$</span><span class="va">fitted</span><span class="op">)</span>,</span>
<span>  linetype<span class="op">=</span><span class="fl">1</span>, colour<span class="op">=</span><span class="st">"red"</span>, </span>
<span>  arrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">proj</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The blue line minimizes the sum of squares<br>
of the vertical residuals (in red).</p>
<p><br></p>
<p>What is the variance of the points<br>
along the blue line?</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matproj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">weight</span>, <span class="va">reg1</span><span class="op">$</span><span class="va">fitted</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">matproj</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.65</code></pre>
</div>
</div>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/unnamed-chunk-8-1.png" width="480"></p>
</div>
</div>
</div>
</div>
</div>
</section><section class="slide level1"><h3 id="regression-of-weight-on-discus">Regression of weight on discus</h3>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/Reg2-1.png" width="480"></p>
</div>
</div>
<p>Variance of points:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">matproj2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">weight</span>, <span class="va">reg2</span><span class="op">$</span><span class="va">fitted</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">matproj</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.65</code></pre>
</div>
</div>
<p>The orange line minimizes the horizontal residuals for the weight variable in orange.</p>
<h2 id="the-pca-line-it-minimizes-in-both-directions">The PCA line: it minimizes in both directions</h2>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">athletes</span><span class="op">$</span><span class="va">disc</span>, <span class="va">athletes</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span>
<span><span class="va">svda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span>
<span><span class="va">pc</span> <span class="op">&lt;-</span> <span class="va">xy</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">svda</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">svda</span><span class="op">$</span><span class="va">v</span><span class="op">[</span> ,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="va">svda</span><span class="op">$</span><span class="va">v</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">svda</span><span class="op">$</span><span class="va">v</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">ap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pc</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">bp</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pc</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>xend<span class="op">=</span><span class="va">pc</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, yend<span class="op">=</span><span class="va">pc</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept<span class="op">=</span><span class="va">ap</span>, slope<span class="op">=</span><span class="va">bp</span>, col<span class="op">=</span><span class="st">"purple"</span>, lwd<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/PCAmin-plot-1.png" width="288"></p>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/PCAR1R2-1.png" width="288"></p>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><br> The purple line minimizes<br>
both residuals and thus<br>
(through Pythagoras) it<br>
minimizes the sum of<br>
squared distances from<br>
the points to the line.</p>
</div>
</div>
</div>
<p><em>Minimizing the distance to the line in both directions,<br>
the purple line is the principal component line,<br>
the green and blue lines are the regression lines.</em></p>
</section><section id="variance-along-the-line" class="slide level1"><h1>Variance along the line</h1>
<p>The lines created here are sensitive to the choice of units;<br>
because we have made the standard deviations equal to one for both variables,<br>
the PCA line is the diagonal that cuts exactly in the middle of both regression lines.</p>
<p>The data were centered by subtracting their means, thus<br>
ensuring that the line passes through the origin <span class="math inline">\((0,0)\)</span>.</p>
<p>Compute the variance of the points on the purple line.</p>
<p>The coordinates of the points when we made the plot, these are in the <code>pc</code> vector:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">pc</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.903 0.903</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">pc</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.81</code></pre>
</div>
</div>
<h2 id="pca-for-2-dimensional-data">PCA for 2 dimensional data</h2>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ppdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  PC1n<span class="op">=</span><span class="op">-</span><span class="va">svda</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">svda</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>  PC2n<span class="op">=</span> <span class="va">svda</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">svda</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ppdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC1n</span>,y<span class="op">=</span><span class="va">PC2n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"PC1"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"PC2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.5</span>, <span class="fl">2.7</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, color<span class="op">=</span><span class="st">"purple"</span>, lwd<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC1n</span>, y<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend<span class="op">=</span><span class="va">PC1n</span>, yend<span class="op">=</span><span class="fl">0</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> </span>
<span><span class="va">p</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/CompareSDs-plot-1.png" width="480"></p>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/CompareSDblue-1.png" width="480"></p>
</div>
</div>
</div>
</div>
</section><section id="notes-about-lines" class="slide level1"><h1>Notes about Lines</h1>
<p>The line created here is sensitive to the choice of units, and to the center of the cloud.</p>
<p>Note that Pythagoras’ theorem tells us two interesting things here:<br>
if we are minimizing in both horizontal and vertical directions, we are<br>
in fact nminimizing the diagonal projections onto the line from each point.</p>
<h2 id="principal-components-are-linear-combinations-of-the-old-variables">Principal Components are Linear Combinations <br> of the ‘old’ variables</h2>
<p>To understand what that a linear combination really is, we can take<br>
an analogy, when making a healthy juice mix, you can follow a recipe.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="resources/Vegetable-Juice.jpg"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img data-src="resources/RecipeVeggie.jpg"></p>
</div>
</div>
</div>
<p><span class="math display">\[V = 2\times \mbox{ Beets }
+ 1 \times \mbox{ Carrots }
+ \frac{1}{2} \mbox{ Gala }
+ \frac{1}{2} \mbox{ GrannySmith }
+ 0.02 \times \mbox{ Ginger }
+ 0.25 \mbox{ Lemon }\]</span></p>
<p>This recipe is a linear combination of individual juice types. In our analogy,<br>
these are replaced by the original variables. The result is a new variable,<br>
the coefficients <span class="math inline">\((2,1,\frac{1}{2},\frac{1}{2},0.02,0.25)\)</span> are called the loadings.</p>
</section><section id="optimal-lines" class="slide level1"><h1>Optimal lines</h1>
<p>A linear combination of variables defines a line in our space in the<br>
same way we say lines in the scatterplot plane for two dimensions.<br>
As we saw in that case, there are many ways to choose lines onto which<br>
we project the data, there is however a ‘best’ line for our purposes.</p>
<p><strong>Total variance can be decomposed:</strong><br>
The total sums of squares of the distances between the points and any line<br>
can be decomposed into the distance to the line and the variance along the line.</p>
<p>We saw that the principal component minimizes the distance to the line,<br>
and it also maximizes the variance of the projections along the line.</p>
</section><section id="good-projections" class="slide level1"><h1>Good Projections</h1>
<p>What is this?</p>
<p><img data-src="resources/CAM3.png"></p>
</section><section id="good-projections-1" class="slide level1"><h1>Good Projections</h1>
<p>Which projection do you think is better?</p>
<p><img data-src="resources/CAM4.png"></p>
<p>It’s the projection that maximizes the area of the shadow.<br>
An equivalent measurement is the sums of squares of the distances between points<br>
in the projection: we want to see as much of the variation as possible – that’s what PCA does.</p>
</section><section id="the-pca-workflow" class="slide level1"><h1>The PCA workflow</h1>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>PCA is based on the principle of finding<br>
the largest axis of inertia/variability,<br>
and then iterating to find the next best axis<br>
that is orthogonal to the previous one and so on.</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="resources/smallorgacp1.png"></p>
<p></p><figcaption>Many Choices have to made during PCA processing.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<h2 id="the-inner-workings-of-pca-the-singular-value-decomposition">The Inner Workings of PCA: <br> the Singular Value Decomposition</h2>
<p>Eigenvalues of X’X or Singular values of X tell us the rank.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="column quarto-layout-cell" style="flex-basis: 40.0%;justify-content: center;">
<p>What does rank mean?</p>
<pre><code>   X |  2  4  8  
  ---| --------
   1 | 
   2 |
   3 |
   4 |</code></pre>
<pre><code>  X  |  2  4  8  
  -- | ---------
  1  |  2
  2  |  4
  3  |  6
  4  |  8</code></pre>
<pre><code>  X  |  2  4  8  
  ---| --------
   1 |  2  4  8
   2 |  4  8 16
   3 |  6 12 24
   4 |  8 16 32 
</code></pre>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 60.0%;justify-content: center;">
<p>We say that the matrix</p>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp;  4 &amp;  8 \\
4 &amp;  8 &amp; 16 \\
6 &amp; 12 &amp; 24 \\
8 &amp; 16 &amp; 32 \\
\end{pmatrix}
\]</span></p>
<p>is of rank one.</p>
</div>
</div>
</div>
<p><span class="math display">\[
\begin{pmatrix}
2 &amp;  4 &amp;  8 \\
4 &amp;  8 &amp; 16 \\
6 &amp; 12 &amp; 24 \\
8 &amp; 16 &amp; 32 \\
\end{pmatrix}
== u * t(v) = u * v', \qquad
u = \left(\begin{smallmatrix}
1 \\ 2\\ 3 \\ 4
\end{smallmatrix}\right)
\mbox{ and } v'=t(v)=(2\;4\;8) .
\]</span></p>
<h2 id="backwards-from-the-matrix-to-decomposition">Backwards from the matrix to decomposition</h2>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">780</span>,  <span class="fl">75</span>,  <span class="fl">540</span>, <span class="fl">936</span>, </span>
<span>   <span class="fl">90</span>, <span class="fl">648</span>, <span class="fl">1300</span>, <span class="fl">125</span>,</span>
<span>  <span class="fl">900</span>, <span class="fl">728</span>,   <span class="fl">70</span>, <span class="fl">504</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">X</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]  780  936 1300  728
[2,]   75   90  125   70
[3,]  540  648  900  504</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">u1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.01</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">v1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.06</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fl">2348.2</span></span>
<span><span class="va">s1</span> <span class="op">*</span> <span class="va">u1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">v1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3]  [,4]
[1,] 751.4  939 1315 751.4
[2,]  93.9  117  164  93.9
[3,] 563.6  704  986 563.6</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X</span> <span class="op">-</span> <span class="va">s1</span> <span class="op">*</span> <span class="va">u1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">v1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]   [,2]  [,3]  [,4]
[1,]  28.6  -3.28 -15.0 -23.4
[2,] -18.9 -27.41 -39.4 -23.9
[3,] -23.6 -56.46 -86.2 -59.6</code></pre>
</div>
</div>
<!-- ???
# Graphical Decompositions


::: {.cell}

```{.r .cell-code}
# <img src="/Users/susan/Dropbox/images/testsmallmosaic.jpg" alt="Decompose1" style="width: 400px;"/>
# 
# Matrix $X$ we would like to decompose.
# 
# <img src="/Users/susan/Books/CUBook/images/SVD-mosaicXplot1.png" alt="Decompose1" style="width: 400px;"/>
# 
# Areas are proportional to the  entries
# 
# <img src="/Users/susan/Books/CUBook/images/SVD-mosaicXplot2.png" alt="Decompose2" style="width: 400px;"/>
# 
# Looking at different possible margins
# 
# <img src="/Users/susan/Books/CUBook/images/SVD-mosaicXplot3.png" alt="Decompose3" style="width: 400px;"/>
```
:::


Forcing the margins to have norm $1$
-->
<h2 id="check-with-r">Check with R</h2>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## check X</span></span>
<span><span class="va">u1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8196</span>, <span class="fl">0.0788</span>, <span class="fl">0.5674</span><span class="op">)</span></span>
<span><span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4053</span>, <span class="fl">0.4863</span>, <span class="fl">0.6754</span>, <span class="fl">0.3782</span><span class="op">)</span></span>
<span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fl">2348.2</span></span>
<span><span class="va">s1</span> <span class="op">*</span> <span class="va">u1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">v1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]  780  936 1300  728
[2,]   75   90  125   70
[3,]  540  648  900  504</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Xsub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12.5</span>, <span class="fl">35</span>, <span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">9</span>, <span class="fl">14</span>, <span class="fl">26</span>, <span class="fl">18</span>, <span class="fl">16</span>, <span class="fl">21</span>, <span class="fl">49</span>, </span>
<span>  <span class="fl">32</span>, <span class="fl">18</span>, <span class="fl">28</span>, <span class="fl">52</span>, <span class="fl">36</span>, <span class="fl">18</span>, <span class="fl">10.5</span>, <span class="fl">64.5</span>, <span class="fl">36</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Xsub</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,] 12.5 35.0 25.0   25
[2,]  9.0 14.0 26.0   18
[3,] 16.0 21.0 49.0   32
[4,] 18.0 28.0 52.0   36
[5,] 18.0 10.5 64.5   36</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">USV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">Xsub</span><span class="op">)</span></span>
<span><span class="va">USV</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$d
[1] 1.35e+02 2.81e+01 3.42e-15 3.82e-16

$u
       [,1]    [,2]   [,3]    [,4]
[1,] -0.344  0.7717  0.534  0.0246
[2,] -0.264  0.0713 -0.269  0.2725
[3,] -0.475 -0.0415 -0.287  0.7022
[4,] -0.528  0.1426 -0.519 -0.6434
[5,] -0.554 -0.6143  0.539 -0.1341

$v
       [,1]    [,2]   [,3]   [,4]
[1,] -0.250  0.0404 -0.883 -0.394
[2,] -0.343  0.8798  0.239 -0.227
[3,] -0.755 -0.4668  0.334 -0.317
[4,] -0.500  0.0808 -0.226  0.832</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## check USV</span></span>
<span><span class="va">Xsub</span><span class="op">-</span><span class="op">(</span><span class="fl">135</span><span class="op">*</span><span class="va">USV</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">USV</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]   [,2]    [,3]    [,4]
[1,]  0.8802  19.05 -10.088  1.7604
[2,]  0.0849   1.76  -0.921  0.1698
[3,] -0.0396  -1.01   0.565 -0.0792
[4,]  0.1698   3.53  -1.842  0.3397
[5,] -0.6877 -15.15   8.069 -1.3754</code></pre>
</div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Xsub</span><span class="op">-</span><span class="op">(</span><span class="fl">135</span><span class="op">*</span><span class="va">USV</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">USV</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="op">(</span><span class="fl">28.1</span><span class="op">*</span><span class="va">USV</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">USV</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]     [,2]   [,3]    [,4]
[1,] 0.00387 -0.02528 0.0335 0.00774
[2,] 0.00398  0.00264 0.0140 0.00796
[3,] 0.00749  0.01192 0.0214 0.01498
[4,] 0.00796  0.00527 0.0281 0.01592
[5,] 0.00983  0.03784 0.0123 0.01965</code></pre>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Xsub</span><span class="op">-</span><span class="va">USV</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">USV</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">USV</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">-</span><span class="va">USV</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">USV</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">USV</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]      [,2]      [,3]      [,4]
[1,] 4.66e-15  0.00e+00 -7.11e-15 -2.22e-16
[2,] 2.15e-15 -1.78e-15  7.88e-15  1.94e-16
[3,] 2.94e-15 -2.22e-15  1.58e-14  6.22e-15
[4,] 4.41e-15 -1.33e-15  1.47e-14  5.55e-16
[5,] 2.22e-15 -5.33e-15  2.31e-14  9.10e-15</code></pre>
</div>
</div>
<h2 id="another-example">Another Example</h2>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Xsub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12.5</span>, <span class="fl">35</span>, <span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">9</span>, <span class="fl">14</span>, <span class="fl">26</span>, <span class="fl">18</span>, <span class="fl">16</span>, <span class="fl">21</span>, <span class="fl">49</span>,</span>
<span>  <span class="fl">32</span>, <span class="fl">18</span>, <span class="fl">28</span>, <span class="fl">52</span>, <span class="fl">36</span>, <span class="fl">18</span>, <span class="fl">10.5</span>, <span class="fl">64.5</span>, <span class="fl">36</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Xsub</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,] 12.5 35.0 25.0   25
[2,]  9.0 14.0 26.0   18
[3,] 16.0 21.0 49.0   32
[4,] 18.0 28.0 52.0   36
[5,] 18.0 10.5 64.5   36</code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">Xsub</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$d
[1] 1.35e+02 2.81e+01 3.42e-15 3.82e-16

$u
       [,1]    [,2]   [,3]    [,4]
[1,] -0.344  0.7717  0.534  0.0246
[2,] -0.264  0.0713 -0.269  0.2725
[3,] -0.475 -0.0415 -0.287  0.7022
[4,] -0.528  0.1426 -0.519 -0.6434
[5,] -0.554 -0.6143  0.539 -0.1341

$v
       [,1]    [,2]   [,3]   [,4]
[1,] -0.250  0.0404 -0.883 -0.394
[2,] -0.343  0.8798  0.239 -0.227
[3,] -0.755 -0.4668  0.334 -0.317
[4,] -0.500  0.0808 -0.226  0.832</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">USV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">Xsub</span><span class="op">)</span></span>
<span><span class="va">XS1</span> <span class="op">&lt;-</span> <span class="va">Xsub</span> <span class="op">-</span> <span class="va">USV</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">USV</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">USV</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">XS1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]   [,2]    [,3]   [,4]
[1,]  0.8748  19.05 -10.104  1.750
[2,]  0.0808   1.76  -0.933  0.162
[3,] -0.0470  -1.02   0.543 -0.094
[4,]  0.1616   3.52  -1.866  0.323
[5,] -0.6963 -15.16   8.043 -1.393</code></pre>
</div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">XS2</span> <span class="op">&lt;-</span> <span class="va">XS1</span> <span class="op">-</span> <span class="va">USV</span><span class="op">$</span><span class="va">d</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">USV</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">USV</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">XS2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1]      [,2]      [,3]      [,4]
[1,] 4.66e-15  0.00e+00 -7.11e-15 -2.22e-16
[2,] 2.15e-15 -1.78e-15  7.88e-15  1.94e-16
[3,] 2.94e-15 -2.22e-15  1.58e-14  6.22e-15
[4,] 4.41e-15 -1.33e-15  1.47e-14  5.55e-16
[5,] 2.22e-15 -5.33e-15  2.31e-14  9.10e-15</code></pre>
</div>
</div>
<h2 id="special-example-of-rank-one-matrix-independence">Special Example of Rank one matrix: independence</h2>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span></span>
<span><span class="va">HairColor</span> <span class="op">&lt;-</span> <span class="va">HairEyeColor</span><span class="op">[</span>, , <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">HairColor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Eye
Hair    Brown Blue Hazel Green
  Black    36    9     5     2
  Brown    66   34    29    14
  Red      16    7     7     7
  Blond     4   64     5     8</code></pre>
</div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">HairColor</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  HairColor
X-squared = 107, df = 9, p-value &lt;2e-16</code></pre>
</div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html">sweep</a></span><span class="op">(</span><span class="va">HairColor</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">HairColor</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span>, <span class="st">"/"</span><span class="op">)</span></span>
<span><span class="va">pcols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html">sweep</a></span><span class="op">(</span><span class="va">HairColor</span>, <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">HairColor</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span>, <span class="st">"/"</span><span class="op">)</span></span>
<span><span class="va">Indep</span> <span class="op">&lt;-</span> <span class="fl">313</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">prows</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">pcols</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Indep</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Hair
Hair    Black Brown Red Blond
  Black    72   158  39    44
  Brown    57   154  40    61
  Red      55   155  44    59
  Blond    28   108  27   149</code></pre>
</div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">Indep</span><span class="op">-</span><span class="va">HairColor</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">Indep</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 799</code></pre>
</div>
</div>
<h2 id="svd-for-real-data">SVD for real data</h2>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diabetes.svd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">[</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">diabetes.svd</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "d" "u" "v"</code></pre>
</div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">diabetes.svd</span><span class="op">$</span><span class="va">d</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20.09 13.38  9.89  5.63  1.70</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">turtles.svd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">turtles</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">turtles.svd</span><span class="op">$</span><span class="va">d</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.75  1.42  1.00</code></pre>
</div>
</div>
</section><section id="svd" class="slide level1"><h1>SVD</h1>
<div class="cell">

</div>
<p><span class="math display">\[
{\Large X
= u_{\bullet 1} * s_1 * v_{\bullet 1}
+ u_{\bullet 2} * s_2 * v_{\bullet 2}
+ u_{\bullet 3} * s_3 * v_{\bullet 3}
+\dots}
\]</span></p>
<p>We write our horizontal/vertical decomposition of the matrix <span class="math inline">\(X\)</span> in short hand as:</p>
<p><span class="math display">\[{\Large X = USV', V'V=I, U'U=I, S}\]</span></p>
<p>(*diagonal matrix of singular values, given by the <code>d</code> component in the R function)</p>
<p><br></p>
<p>The crossproduct of X with itself verifies</p>
<p><span class="math display">\[{\Large X'X=VSU'USV'=VS^2V'=V\Lambda V'}\]</span></p>
<p>where <span class="math inline">\(V\)</span> is called the eigenvector matrix of the symmetric matrix <span class="math inline">\(X'X\)</span><br>
and <span class="math inline">\(\Lambda\)</span> is the diagonal matrix of eigenvalues of <span class="math inline">\(X'X\)</span>.</p>
</section><section id="why-eigenvectors-are-useful" class="slide level1"><h1>Why Eigenvectors are useful?</h1>
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="resources/xkcdEigenVectors.png"></p>
<p></p><figcaption>Why would eigenvectors come into use in Cinderella?</figcaption><p></p>
</figure>
</div>
<p><a href="https://www.khanacademy.org/math/linear-algebra/alternate-bases/eigen-everything/v/linear-algebra-introduction-to-eigenvalues-and-eigenvectors">Khan’s Academy</a></p>
</section><section id="principal-components" class="slide level1"><h1>Principal Components</h1>
<p>The singular vectors from the singular value decomposition,<br><code>svd</code> function above, tell us the coefficients to put in front<br>
of the old variables to make our new ones with better properties.</p>
<p>We write this as:</p>
<p><span class="math display">\[PC_1=c_1 X_{\bullet 1} +c_2 X_{\bullet 2}+ c_3 X_{\bullet 3}+\cdots c_p X_{\bullet p}\]</span></p>
<p>Replace <span class="math inline">\(X_{\bullet 1},X_{\bullet 2}, \ldots X_{\bullet p}\)</span> by <span class="math display">\[PC_1, PC_2, \ldots PC_k\]</span></p>
<h2 id="what-is-the-largest-k-can-be">What is the largest k can be ?</h2>
<p>Suppose we have 5 samples with 23,000 genes measured<br>
on them, what is the dimensionality of these data?</p>
<p>The number of principal components is less than<br>
or equal to the number of original variables.</p>
<p><span class="math display">\[K\leq min(n,p)\]</span></p>
<p>The geometr(ies) of data: good trick look at size of vectors:</p>
<div class="cell">

</div>
<div class="cell">

</div>
<p>The Principal Component transformation is defined in such a way that</p>
<ul>
<li>The first principal component has the largest possible variance<br>
(that is, accounts for as much of the variability in the data as possible).</li>
<li>Each successive component in turn has the highest variance possible<br>
under the constraint that it be orthogonal to the preceding components.</li>
</ul>
<p><span class="math display">\[\max_{aX} \mbox{var}(Proj_{aX} (X))\]</span></p>
<p>Suppose the matrix of data <span class="math inline">\(X\)</span> has been made<br>
to have column means 0 and standard deviations 1.</p>
</section><section id="matrix-decomposition" class="slide level1"><h1>Matrix Decomposition</h1>
<p>We call the principal components the columns of the matrix, <span class="math inline">\(C=US\)</span>.</p>
<p>The columns of U (the matrix given as USV$u in the output from the <code>svd</code> function above)<br>
are rescaled to have norm <span class="math inline">\(s^2\)</span>, the variance they are responsable for.</p>
<p>If the matrix <span class="math inline">\(X\)</span> comes from the study of <span class="math inline">\(n\)</span> different samples or specimens,<br>
then the principal components provides new coordinates for these <span class="math inline">\(n\)</span> points.<br>
these are sometimes also called the scores in some of the (many) PCA functions<br>
available in R (<code>princomp</code>,<code>prcomp</code>,<code>dudi.pca</code> in <code>ade4</code>).</p>
</section><section id="transition-formulae" class="slide level1"><h1>Transition Formulae</h1>
<p>If we only want the first one then it is just <span class="math inline">\(c_1=s_1 u_1\)</span>.</p>
<p>Variance explained by first principal component: <span class="math inline">\(s_1^2\)</span>:</p>
<p>Notice that <span class="math inline">\(||c_1||^2=s_1'u_1 u_1' s_1= s_1^2 u_1'u_1=s_1^2=\lambda_1\)</span></p>
<p><span class="math display">\[X'C=VSU'US=VS^2\]</span></p>
</section><section id="remarks" class="slide level1"><h1>Remarks:</h1>
<ol type="1">
<li>Each principal component is chosen to maximize the variance it<br>
explains; this variance is measured by the corresponding eigenvalue.<br>
</li>
<li>The new variables are made to be orthogonal, if the data.<br>
are multivariate normal the new variables will be independent.<br>
</li>
<li>When the variables are rescaled or we choose the correlation matrix<br>
as the one we want to study instead of the covariance matrix,<br>
then the sum of the variances of all the variables is the<br>
number of variables (= p), this is sometimes called the trace.<br>
</li>
<li>The principal components are always ordered by `importance’,<br>
always look at what proportion of the variability you are interpreting<br>
(and check the screeplot before deciding how many components).</li>
</ol></section><section id="a-few-examples-of-using-pca" class="slide level1"><h1>A few examples of using PCA</h1>
<p>We start with the turtles data that has 3 continuous variables and<br>
a gender variable that we leave out for the original PCA analysis.</p>
<h2 id="turtles-data">Turtles Data</h2>
<p>When computing the variance covariance matrix, many programs use <span class="math inline">\(1/(n-1)\)</span> as the denominator.<br>
Here, <span class="math inline">\(n=48\)</span>, so the sum of the variances are off by a small fudge factor of <span class="math inline">\(48/47\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">turtles3var</span> <span class="op">&lt;-</span> <span class="va">turtles</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">turtles3var</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>length  width height 
 124.7   95.4   46.3 </code></pre>
</div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">turtles.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/princomp.html">princomp</a></span><span class="op">(</span><span class="va">turtles3var</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">turtles.pca</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
princomp(x = turtles3var)

Standard deviations:
Comp.1 Comp.2 Comp.3 
 25.06   2.26   1.94 

 3  variables and  48 observations.</code></pre>
</div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="op">(</span><span class="fl">25.06</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">2.26</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">1.94</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">48</span><span class="op">/</span><span class="fl">47</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 650</code></pre>
</div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">turtles3var</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>length  width height 
 419.5  160.7   70.4 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">turtles</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>length  width height 
 20.48  12.68   8.39 </code></pre>
</div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">turtlesc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">turtles</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">turtlesc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       length width height
length  1.000 0.978  0.965
width   0.978 1.000  0.961
height  0.965 0.961  1.000</code></pre>
</div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/princomp.html">princomp</a></span><span class="op">(</span><span class="va">turtlesc</span><span class="op">)</span></span>
<span><span class="va">pca1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
princomp(x = turtlesc)

Standard deviations:
Comp.1 Comp.2 Comp.3 
 1.695  0.205  0.145 

 3  variables and  48 observations.</code></pre>
</div>
</div>
</section><section id="step-one-always-the-screeplot" class="slide level1"><h1>Step one: always the screeplot</h1>
<p>The screeplot showing the eigenvalues for the standardized data:<br>
one very large component in this case and two very small ones,<br>
the data are (almost) one dimensional.</p>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca.turtles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">turtles</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, scannf<span class="op">=</span><span class="cn">FALSE</span>, nf<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/scatter.html">scatter</a></span><span class="op">(</span><span class="va">pca.turtles</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/turtlesbiplot-1.png" width="480"></p>
</div>
</div>
</section><section id="why" class="slide level1"><h1>Why ?</h1>
<p>Choose k carefully:</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/screeploteq-1.png" width="480"></p>
</div>
</div>
</section><section id="step-two-variables" class="slide level1"><h1>Step Two: Variables</h1>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/turtlesCircle-1.png" width="480"></p>
</div>
</div>
</section><section id="biplot" class="slide level1"><h1>Biplot</h1>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/turtlesbiplotfunction-1.png" width="480"></p>
</div>
</div>
</section><section id="all-together" class="slide level1"><h1>All together</h1>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/scatter.html">scatter</a></span><span class="op">(</span><span class="va">pca.turtles</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/scatterturtles-1.png" width="480"></p>
</div>
</div>
<p>Exercise: How are the following numbers related?</p>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/svd.html">svd</a></span><span class="op">(</span><span class="va">turtlesc</span><span class="op">)</span><span class="op">$</span><span class="va">d</span> <span class="op">/</span> <span class="va">pca1</span><span class="op">$</span><span class="va">sdev</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.86 6.86 6.86</code></pre>
</div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">47</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.86</code></pre>
</div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">turtlesc</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 48</code></pre>
</div>
</div>
<h2 id="lizards-data-analyses">Lizards Data Analyses</h2>
<p>This data set describes 18 lizards as reported by Bauwens and D'iaz-Uriarte (1997).<br>
It also gives life-history traits corresponding to these 18 species.</p>
<ul>
<li>
<code>mean.L</code> (mean length (mm)), <code>matur.L</code> (length at maturity (mm)),<br>
</li>
<li>
<code>max.L</code> (maximum length (mm)), <code>hatch.L</code> (hatchling length (mm)),<br>
</li>
<li>
<code>hatch.m</code> (hatchling mass (g)), <code>clutch.S</code> (Clutch size),<br>
</li>
<li>
<code>age.mat</code> (age at maturity (number of months of activity)),<br>
</li>
<li>
<code>clutch.F</code> (clutch frequency).</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">lizards</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">lizards</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "traits" "hprA"   "hprB"  </code></pre>
</div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lizards</span><span class="op">$</span><span class="va">traits</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table>
<colgroup>
<col style="width: 4%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mean.L</th>
<th style="text-align: right;">matur.L</th>
<th style="text-align: right;">max.L</th>
<th style="text-align: right;">hatch.L</th>
<th style="text-align: right;">hatch.m</th>
<th style="text-align: right;">clutch.S</th>
<th style="text-align: right;">age.mat</th>
<th style="text-align: right;">clutch.F</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sa</td>
<td style="text-align: right;">69.2</td>
<td style="text-align: right;">58</td>
<td style="text-align: right;">82</td>
<td style="text-align: right;">27.8</td>
<td style="text-align: right;">0.572</td>
<td style="text-align: right;">6.0</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sh</td>
<td style="text-align: right;">48.4</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">22.9</td>
<td style="text-align: right;">0.310</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tl</td>
<td style="text-align: right;">168.4</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">190</td>
<td style="text-align: right;">42.8</td>
<td style="text-align: right;">2.235</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mc</td>
<td style="text-align: right;">66.1</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">25.0</td>
<td style="text-align: right;">0.441</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>It is always a good idea to check the variables one at a time and two at a time to see what the basic statistics are for the data</p>
<div class="cell">
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tabtraits</span> <span class="op">&lt;-</span> <span class="va">lizards</span><span class="op">$</span><span class="va">traits</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">tabtraits</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mean.L  matur.L    max.L  hatch.L  hatch.m clutch.S  age.mat clutch.F 
   71.34    59.39    82.83    26.88     0.56     5.87    10.89     1.56 </code></pre>
</div>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">tabtraits</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         mean.L matur.L max.L hatch.L hatch.m clutch.S age.mat clutch.F
mean.L     1.00    0.99  0.99    0.89    0.94     0.92    0.77    -0.48
matur.L    0.99    1.00  0.99    0.90    0.92     0.92    0.79    -0.49
max.L      0.99    0.99  1.00    0.88    0.92     0.91    0.78    -0.51
hatch.L    0.89    0.90  0.88    1.00    0.96     0.72    0.58    -0.42
hatch.m    0.94    0.92  0.92    0.96    1.00     0.78    0.64    -0.45
clutch.S   0.92    0.92  0.91    0.72    0.78     1.00    0.81    -0.55
age.mat    0.77    0.79  0.78    0.58    0.64     0.81    1.00    -0.62
clutch.F  -0.48   -0.49 -0.51   -0.42   -0.45    -0.55   -0.62     1.00</code></pre>
</div>
</div>
<h2 id="biplot-1">Biplot</h2>
<div class="cell">
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">tabtraits</span>, scannf<span class="op">=</span><span class="cn">FALSE</span>, nf<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Duality diagramm
class: pca dudi
$call: dudi.pca(df = tabtraits, scannf = FALSE, nf = 2)

$nf: 2 axis-components saved
$rank: 8
eigen values: 6.5 0.83 0.42 0.17 0.045 ...
  vector length mode    content       
1 $cw    8      numeric column weights
2 $lw    18     numeric row weights   
3 $eig   8      numeric eigen values  

  data.frame nrow ncol content             
1 $tab       18   8    modified array      
2 $li        18   2    row coordinates     
3 $l1        18   2    row normed scores   
4 $co        8    2    column coordinates  
5 $c1        8    2    column normed scores
other elements: cent norm </code></pre>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/unnamed-chunk-27-1.png" width="480"></p>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/unnamed-chunk-28-1.png" width="480"></p>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">res</span><span class="op">$</span><span class="va">eig</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.81118 0.10387 0.05219 0.02133 0.00563 0.00488 0.00061 0.00031</code></pre>
</div>
</div>
</section><section id="the-decathlon-athletes" class="slide level1"><h1>The Decathlon Athletes</h1>
<div class="cell">
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">athletes</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       m100 long weight highj m400 m110 disc pole javel m1500
m100    1.0 -0.5   -0.2  -0.1  0.6  0.6  0.0 -0.4  -0.1   0.3
long   -0.5  1.0    0.1   0.3 -0.5 -0.5  0.0  0.3   0.2  -0.4
weight -0.2  0.1    1.0   0.1  0.1 -0.3  0.8  0.5   0.6   0.3
highj  -0.1  0.3    0.1   1.0 -0.1 -0.3  0.1  0.2   0.1  -0.1
m400    0.6 -0.5    0.1  -0.1  1.0  0.5  0.1 -0.3   0.1   0.6
m110    0.6 -0.5   -0.3  -0.3  0.5  1.0 -0.1 -0.5  -0.1   0.1
disc    0.0  0.0    0.8   0.1  0.1 -0.1  1.0  0.3   0.4   0.4
pole   -0.4  0.3    0.5   0.2 -0.3 -0.5  0.3  1.0   0.3   0.0
javel  -0.1  0.2    0.6   0.1  0.1 -0.1  0.4  0.3   1.0   0.1
m1500   0.3 -0.4    0.3  -0.1  0.6  0.1  0.4  0.0   0.1   1.0</code></pre>
</div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pca.ath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">athletes</span>, scan<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pca.ath</span><span class="op">$</span><span class="va">eig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 3.42 2.61 0.94 0.88 0.56 0.49 0.43 0.31 0.27 0.10</code></pre>
</div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">pca.ath</span><span class="op">$</span><span class="va">eig</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/ade4athletes-1.png" width="480"></p>
</div>
</div>
<p>The screeplot is the first thing to look at, it tells us<br>
that it is satisfactory to use a two dimensional plot.</p>
<h2 id="correlation-circle">Correlation Circle</h2>
<p>The correlation circle made by showing the projection of<br>
the old variables onto the two first new principal axes:</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell">
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">pca.ath</span><span class="op">$</span><span class="va">co</span>, clab<span class="op">=</span><span class="fl">1</span>, grid<span class="op">=</span><span class="cn">FALSE</span>, fullcircle<span class="op">=</span><span class="cn">TRUE</span>, box<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/athletecorr-1.png" width="336"></p>
</div>
</div>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">athletes</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">athletes</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">athletes</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       m100 long weight highj m400 m110 disc pole javel m1500
m100    1.0  0.5    0.2   0.1  0.6  0.6  0.0  0.4   0.1   0.3
long    0.5  1.0    0.1   0.3  0.5  0.5  0.0  0.3   0.2   0.4
weight  0.2  0.1    1.0   0.1 -0.1  0.3  0.8  0.5   0.6  -0.3
highj   0.1  0.3    0.1   1.0  0.1  0.3  0.1  0.2   0.1   0.1
m400    0.6  0.5   -0.1   0.1  1.0  0.5 -0.1  0.3  -0.1   0.6
m110    0.6  0.5    0.3   0.3  0.5  1.0  0.1  0.5   0.1   0.1
disc    0.0  0.0    0.8   0.1 -0.1  0.1  1.0  0.3   0.4  -0.4
pole    0.4  0.3    0.5   0.2  0.3  0.5  0.3  1.0   0.3   0.0
javel   0.1  0.2    0.6   0.1 -0.1  0.1  0.4  0.3   1.0  -0.1
m1500   0.3  0.4   -0.3   0.1  0.6  0.1 -0.4  0.0  -0.1   1.0</code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pcan.ath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">athletes</span>, scannf<span class="op">=</span><span class="cn">FALSE</span>, nf<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">pcan.ath</span><span class="op">$</span><span class="va">eig</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 3.42 2.61 0.94 0.88 0.56 0.49 0.43 0.31 0.27 0.10</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Now all the negative correlations are quite small ones.<br>
Doing the screeplot over again will show no change in the eigenvalues,<br>
the only thing that changes is the sign of loadings for the m variables.</p>
</section><section id="new-data-changing-signs" class="slide level1"><h1>New Data changing signs</h1>
<div class="cell">
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.corcircle.html">s.corcircle</a></span><span class="op">(</span><span class="va">pcan.ath</span><span class="op">$</span><span class="va">co</span>, clab<span class="op">=</span><span class="fl">1.2</span>, box<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/athletecorrn-1.png" width="480"></p>
</div>
</div>
<p><em>Correlation circle after changing the signs of the running variables.</em></p>
</section><section id="observations" class="slide level1"><h1>Observations</h1>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/athletepc-1.png" width="403"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">olympic</span><span class="op">)</span></span>
<span><span class="va">olympic</span><span class="op">$</span><span class="va">score</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 8488 8399 8328 8306 8286 8272 8216 8189 8180 8167 8143 8114 8093 8083 8036
[16] 8021 7869 7860 7859 7781 7753 7745 7743 7623 7579 7517 7505 7422 7310 7237
[31] 7231 7016 6907</code></pre>
</div>
</div>
</section><section id="link-to-overall-scores" class="slide level1"><h1>Link to overall scores</h1>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/AthleteScorePCA-1.png" width="480"></p>
</div>
</div>
<!-- (/Users/susan/gitbiobook/BioBook/Chap8-IntroMultivariate/figure/chap8-AthleteScorePCA.png) -->
<p><em>Scatterplot of the scores given as a supplementary variable and the first principal component;<br>
the points are labeled by their order in the data set.</em></p>
</section><section id="pca-as-an-exploratory-tool-using-meta-information" class="slide level1"><h1>PCA as an exploratory tool: <br> using meta-information</h1>
<div class="cell">
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## center and scale the data </span></span>
<span><span class="co">## (they have already had variance normalization applied to them)</span></span>
<span><span class="va">res.Msig3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">Msig3transp</span>, center<span class="op">=</span><span class="cn">TRUE</span>, scale<span class="op">=</span><span class="cn">TRUE</span>, scannf<span class="op">=</span><span class="cn">FALSE</span>, nf<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html">screeplot</a></span><span class="op">(</span><span class="va">res.Msig3</span>, main<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/tcellexpr-1.png" width="480"></p>
</div>
</div>
<h2 id="plot-by-cell-types">Plot by cell types</h2>
<div class="cell">
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">celltypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">Msig3transp</span><span class="op">)</span>, <span class="fl">7</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">celltypes</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>celltypes
EFF MEM NAI 
 10   9  11 </code></pre>
</div>
</div>
<div class="cell columns column-output-location quarto-layout-panel" data-fig.asp="0.4">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">res.Msig3</span><span class="op">$</span><span class="va">li</span>, Cluster<span class="op">=</span><span class="va">celltypes</span><span class="op">)</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>sample<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">gg</span><span class="op">)</span>, <span class="va">gg</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Axis1</span>, y<span class="op">=</span><span class="va">Axis2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">Cluster</span><span class="op">)</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Cluster"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>,<span class="fl">18</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span>,<span class="fl">8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/tcelltypes-plot-1.png" width="480"></p>
</div>
</div>
</div>
</div>
<p><em>PCA of gene expression for a subset of 156 genes involved in specificities<br>
of each of the three separate T cell types: effector, naive and memory</em></p>
</section><section id="mass-spectroscopy-data-analysis" class="slide level1"><h1>Mass Spectroscopy Data Analysis</h1>
<p>Example from paper: <a href="http://www.pnas.org/content/110/42/17059.full">Kashnap et al, PNAS, 2013</a></p>
<div class="cell">

</div>
</section><section id="sample-situations-in-pc-map" class="slide level1"><h1>Sample situations in PC map</h1>
<div class="cell columns column-output-location quarto-layout-panel" data-fig.asp="0.7">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">##  PCA Example</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"resources/logtmat.RData"</span><span class="op">)</span></span>
<span><span class="va">pca.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">logtmat</span>, scannf<span class="op">=</span><span class="cn">FALSE</span>, nf<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">pca.result</span><span class="op">$</span><span class="va">li</span><span class="op">)</span></span>
<span><span class="va">nos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">labs</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">labs</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">kos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"ko"</span><span class="op">)</span></span>
<span><span class="va">wts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"wt"</span><span class="op">)</span></span>
<span><span class="va">pcs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Axis1<span class="op">=</span><span class="va">pca.result</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, </span>
<span>  Axis2<span class="op">=</span><span class="va">pca.result</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">labs</span>, <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pcsplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">pcs</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Axis1</span>, y<span class="op">=</span><span class="va">Axis2</span>, </span>
<span>  label<span class="op">=</span><span class="va">labs</span>, group<span class="op">=</span><span class="va">nos</span>, colour<span class="op">=</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">4</span>, vjust<span class="op">=</span><span class="op">-</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">pcsplot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="fl">0</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">12</span>,<span class="fl">18</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/VanillaGGplot-1.png" width="800"></p>
</div>
</div>
</div>
</div>
</section><section id="extra-connections" class="slide level1"><h1>Extra Connections</h1>
<div class="cell">
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pcsplot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">12</span>,<span class="fl">18</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/RedConnects-1.png" width="800"></p>
</div>
</div>
<h2 id="checking-data-by-frequent-multivariate-projections">Checking data by frequent multivariate projections</h2>
<p>Phylochip data allowed us to discover a batch effect (phylochip).</p>
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="resources/ThreeSets28s.png"></p>
<p></p><figcaption>Phylochip data for three different batches and two different arrays, first principal plane explains 66% of the total variation.</figcaption><p></p>
</figure>
</div>
<h2 id="weighted-pca">Weighted PCA</h2>
<p>Sometimes we want to see variability between different groups or observations but need to weight them.<br>
This can happen when wanting to summarize data for heterogeneous groups with unequal sizes.</p>
<p>Let’s do this for the specific example of the Hiiragi (Ohnishi2014) data<br>
we saw in Lectures 3 and 5 and show how reweighting is relevant here.</p>
<div class="cell">
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"Hiiragi2013"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2013</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span></span>
<span><span class="va">FGF4probes</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/featureData.html">fData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">symbol</span> <span class="op">==</span> <span class="st">"Fgf4"</span><span class="op">)</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html">pData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">sampleGroup</span><span class="op">)</span></span>
<span><span class="va">safeSelect</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">grpnames</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">grpnames</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">groups</span><span class="op">[</span><span class="va">grpnames</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">safeSelect</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"E3.25"</span>,</span>
<span>                  <span class="st">"E3.5 (EPI)"</span>, <span class="st">"E3.5 (PE)"</span>,</span>
<span>                  <span class="st">"E4.5 (EPI)"</span>, <span class="st">"E4.5 (PE)"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nfeatures</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">varianceOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/genefilter/man/rowSds.html">rowVars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html">exprs</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>, <span class="va">g</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">varianceOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span><span class="op">(</span><span class="va">varianceOrder</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">FGF4probes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">selectedFeatures</span> <span class="op">&lt;-</span> <span class="va">varianceOrder</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">nfeatures</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">sampleColourMap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html">pData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">sampleColour</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html">pData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">sampleGroup</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xwt</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">selectedFeatures</span>, <span class="va">g</span><span class="op">]</span></span>
<span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xwt</span><span class="op">$</span><span class="va">sampleGroup</span><span class="op">)</span></span>
<span><span class="va">tab</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     E3.25 E3.5 (EPI)  E3.5 (PE) E4.5 (EPI)  E4.5 (PE) 
        36         11         11          4          4 </code></pre>
</div>
</div>
</section><section class="slide level1"><p>We want to do a PCA on 66 points from the wild type genotype data, but the groups<br>
are not equally represented, so we will reweight them to even out the representations.</p>
<div class="cell">
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selectedSamples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html">pData</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">genotype</span> <span class="op">==</span> <span class="st">"WT"</span><span class="op">)</span></span>
<span><span class="va">xe</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span>, <span class="va">selectedSamples</span><span class="op">]</span></span>
<span><span class="co">## To account for the different numbers in the groups, we reweight the samples</span></span>
<span><span class="va">wt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">36</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">36</span><span class="op">/</span><span class="fl">11</span>,<span class="fl">11</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">36</span><span class="op">/</span><span class="fl">11</span>,<span class="fl">11</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">36</span><span class="op">/</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">36</span><span class="op">/</span><span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">wt</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 66</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## reweighted of groups using 'dudi.pca'</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://www.sthda.com/english/rpkgs/factoextra">"factoextra"</a></span><span class="op">)</span></span>
<span><span class="va">dfx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html">exprs</a></span><span class="op">(</span><span class="va">xwt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">resPCAD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">dfx</span>, row.w<span class="op">=</span><span class="va">wt</span>, center<span class="op">=</span><span class="cn">TRUE</span>, scale<span class="op">=</span><span class="cn">TRUE</span>, nf<span class="op">=</span><span class="fl">2</span>, scannf<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell">
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/eigenvalue.html">fviz_eig</a></span><span class="op">(</span><span class="va">resPCAD</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/resPCADscree-1.png" width="336"></p>
</div>
</div>
</div>
<div class="column quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell">
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_ind</a></span><span class="op">(</span><span class="va">resPCAD</span>, </span>
<span>  habillage<span class="op">=</span><span class="va">xwt</span><span class="op">$</span><span class="va">sampleGroup</span>,</span>
<span>  col.ind<span class="op">=</span><span class="va">xwt</span><span class="op">$</span><span class="va">sampleColour</span>,</span>
<span>  geom<span class="op">=</span><span class="st">"point"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/resPCADplot-1.png" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section><section id="summary-of-this-lecture" class="slide level1"><h1>Summary of this Lecture</h1>
<ul>
<li>Multivariate data require <code>conscious</code> preprocessing,<br>
to make their variances comparable and their centers at the origin.</li>
<li>When data are matrices with many variables of numerical values,<br>
we can still make useful graphical representations by making projections<br>
on lower dimensions (planes and 3D are the most frequently used).</li>
<li>PCA searches for new <code>more informative</code> variables<br>
which are linear combinations of the old ones.</li>
<li>PCA is based on finding decompositions of the matrix <span class="math inline">\(X\)</span><br>
called SVD, this is equivalent to the eigenanalysis of <span class="math inline">\(X'X\)</span>.<br>
The squares of the singular values are the equal to the<br>
eigenvalues and to the variances of the new variables.</li>
<li>Choosing k: You need to plot the variances/eigenvalues before you<br>
decide how many axes are necessary to reproduce the signal in the data.</li>
<li>Interpretation of PCA is facilitated by redundant<br>
or contiguous meta-data about the observations.</li>
</ul></section><section id="more-examples-of-supplementary-variables" class="slide level1"><h1>More examples of <br> supplementary variables</h1>
<h2 id="one-categorical-variable-project-the-mean-points">One categorical variable: project the mean points</h2>
<div class="cell">
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">ggbiplot</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/wine.RData"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/wineClass.RData"</span><span class="op">)</span></span>
<span><span class="va">wine</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table>
<thead><tr class="header">
<th style="text-align: right;">Alcohol</th>
<th style="text-align: right;">MalicAcid</th>
<th style="text-align: right;">Ash</th>
<th style="text-align: right;">AlcAsh</th>
<th style="text-align: right;">Mg</th>
<th style="text-align: right;">Phenols</th>
<th style="text-align: right;">Flav</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">3.1</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">2.8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">13</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">3.2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/heatmap.html">heatmap</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">wine</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/WineBiplot-1.png" width="480"></p>
</div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">wine.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">wine</span>, scale.<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">wine.class</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>wine.class
    barolo grignolino    barbera 
        59         71         48 </code></pre>
</div>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/factoextra/man/fviz_pca.html">fviz_pca_biplot</a></span><span class="op">(</span><span class="va">wine.pca</span>, </span>
<span>  habillage<span class="op">=</span><span class="va">wine.class</span>, </span>
<span>  addEllipses<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>  circle<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="PCA_SVD_Slides_files/figure-revealjs/WineBiplot-2.png" width="480"></p>
</div>
</div>
<h3 id="projecting-ellipses">Projecting Ellipses</h3>
<p>We’ll see later when we look at Microbiome data that sometimes, this projection can be problematic.</p>
</section><section id="percentage-of-inertia" class="slide level1"><h1>Percentage of Inertia</h1>
<div class="cell">
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://pbil.univ-lyon1.fr/ADE-4/">ade4</a></span><span class="op">)</span></span>
<span><span class="va">res.ath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ade4/man/dudi.pca.html">dudi.pca</a></span><span class="op">(</span><span class="va">athletes</span>, nf<span class="op">=</span><span class="fl">2</span>, scannf<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/inertia.dudi.html">inertia.dudi</a></span><span class="op">(</span><span class="va">res.ath</span>,col.inertia<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Inertia information:
Call: inertia.dudi(x = res.ath, col.inertia = TRUE)

Decomposition of total inertia:
     inertia     cum  cum(%)
Ax1   3.4182   3.418   34.18
Ax2   2.6064   6.025   60.25
Ax3   0.9433   6.968   69.68
Ax4   0.8780   7.846   78.46
Ax5   0.5566   8.403   84.03
Ax6   0.4912   8.894   88.94
Ax7   0.4306   9.324   93.24
Ax8   0.3068   9.631   96.31
Ax9   0.2669   9.898   98.98
Ax10  0.1019  10.000  100.00

Column contributions (%):
   m100    long  weight   highj    m400    m110    disc    pole   javel   m1500 
     10      10      10      10      10      10      10      10      10      10 

Column absolute contributions (%):
         Axis1    Axis2
m100    17.296  2.21439
long    15.528  2.31288
weight   7.242 23.38084
highj    4.506  0.07783
m400    12.663 12.40165
m110    18.791  0.48397
disc     3.090 25.33458
pole    14.752  2.23748
javel    3.238 13.83520
m1500    2.895 17.72118

Signed column relative contributions:
         Axis1    Axis2
m100   -59.121  -5.7716
long   -53.077  -6.0283
weight -24.754  60.9397
highj  -15.404   0.2029
m400   -43.284 -32.3236
m110   -64.231  -1.2614
disc   -10.563  66.0319
pole   -50.426   5.8317
javel  -11.068  36.0600
m1500   -9.895 -46.1884

Cumulative sum of column relative contributions (%):
         Axis1 Axis1:2 Axis3:10
m100    59.121   64.89    35.11
long    53.077   59.11    40.89
weight  24.754   85.69    14.31
highj   15.404   15.61    84.39
m400    43.284   75.61    24.39
m110    64.231   65.49    34.51
disc    10.563   76.60    23.40
pole    50.426   56.26    43.74
javel   11.068   47.13    52.87
m1500    9.895   56.08    43.92</code></pre>
</div>
</div>
<p>Contributions are printed in 1/10000 and the sign is the sign of the coordinate.</p>
<div class="footer footer-default">

</div>
</section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="PCA_SVD_Slides_files/libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="PCA_SVD_Slides_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="PCA_SVD_Slides_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="PCA_SVD_Slides_files/libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="PCA_SVD_Slides_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="PCA_SVD_Slides_files/libs/revealjs/plugin/quarto-support/support.js"></script><script src="PCA_SVD_Slides_files/libs/revealjs/plugin/notes/notes.js"></script><script src="PCA_SVD_Slides_files/libs/revealjs/plugin/search/search.js"></script><script src="PCA_SVD_Slides_files/libs/revealjs/plugin/zoom/zoom.js"></script><script src="PCA_SVD_Slides_files/libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>


</body></html>